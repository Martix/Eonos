From c423f45fee0b6b5148e9ad31a79761b8562e2df8 Mon Sep 17 00:00:00 2001
From: Koen Kooi <koen@dominion.thruhere.net>
Date: Thu, 7 Oct 2010 11:46:01 +0200
Subject: [PATCH 4/8] ARM: OMAP: Power on EHCI, serial, camera and DVI on beagleboard-x<

Signed-off-by: Koen Kooi <koen@beagleboard.org>
---
 arch/arm/mach-omap2/board-omap3beagle.c |   19 +++++++++++++++++++
 1 files changed, 19 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-omap2/board-omap3beagle.c b/arch/arm/mach-omap2/board-omap3beagle.c
index 800ba5b..3bc524c 100644
--- a/arch/arm/mach-omap2/board-omap3beagle.c
+++ b/arch/arm/mach-omap2/board-omap3beagle.c
@@ -399,6 +399,25 @@ static int beagle_twl_gpio_setup(struct device *dev,
 		gpio_direction_output(gpio + TWL4030_GPIO_MAX, 0);
 	}
 
+	/* DVI reset GPIO is different between revisions */
+	if (omap3_beagle_get_rev() == OMAP3BEAGLE_BOARD_XM) {
+		beagle_dvi_device.reset_gpio = 129;
+	} else {
+		beagle_dvi_device.reset_gpio = 170;
+	}
+
+	 /* Power on DVI, Serial and PWR led */
+	if (omap3_beagle_get_rev() == OMAP3BEAGLE_BOARD_XM) {
+		gpio_request(gpio + 1, "nDVI_PWR_EN");
+		gpio_direction_output(gpio + 1, 0);
+	}
+
+	/* Power on camera interface */
+	if (omap3_beagle_get_rev() == OMAP3BEAGLE_BOARD_XM) {
+		gpio_request(gpio + 2, "CAM_EN");
+		gpio_direction_output(gpio + 2, 1);
+	}
+
 	return 0;
 }
 
-- 
1.6.6.1

